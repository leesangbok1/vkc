# Viet K-Connect ê¸°ìˆ  ë¬¸ì„œ (í†µí•©ë³¸)

âœ… **í™œì„± ê°œë°œ ì¤‘ì¸ ê¸°ìˆ  ë¬¸ì„œ**

---

## ğŸ“‹ ë¬¸ì„œ ê°œìš”

ì´ ë¬¸ì„œëŠ” Viet K-Connect í”„ë¡œì íŠ¸ì˜ ê¸°ìˆ ì  ì„¤ê³„ì™€ êµ¬í˜„ ë°©ë²•ì„ ì •ë¦¬í•œ ë¬¸ì„œì…ë‹ˆë‹¤.

---

## ğŸ—ï¸ ì‹œìŠ¤í…œ ì•„í‚¤í…ì²˜

### ì „ì²´ ì•„í‚¤í…ì²˜ ë‹¤ì´ì–´ê·¸ë¨
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT LAYER                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Web Browser   â”‚   Mobile PWA      â”‚   Google Translate    â”‚
â”‚   (Desktop)     â”‚   (iOS/Android)   â”‚   (Extension)         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                 â”‚                      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   Vercel    â”‚
                    â”‚  (CDN/Edge)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     APPLICATION LAYER                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Next.js 14 (App Router)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Pages    â”‚   API       â”‚   Components â”‚   Hooks    â”‚  â”‚
â”‚  â”‚  /auth     â”‚  /api/auth  â”‚   /ui        â”‚  useAuth   â”‚  â”‚
â”‚  â”‚  /questionsâ”‚  /api/qa    â”‚   /features  â”‚  useQuery  â”‚  â”‚
â”‚  â”‚  /admin    â”‚  /api/ai    â”‚   /shared    â”‚  useNotify â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SERVICE LAYER                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Supabase   â”‚   OpenAI     â”‚   Kakao     â”‚    SendGrid     â”‚
â”‚  - Auth     â”‚   GPT-3.5    â”‚   - OAuth   â”‚    Email API    â”‚
â”‚  - Database â”‚   - Classify â”‚   - Share   â”‚                 â”‚
â”‚  - Storage  â”‚   - Match    â”‚   - Alimtalkâ”‚                 â”‚
â”‚  - Realtime â”‚              â”‚             â”‚                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### í•µì‹¬ ê¸°ìˆ  ìŠ¤íƒ
```yaml
Frontend:
  Framework: Next.js 14 (App Router)
  Language: TypeScript 5.0
  Styling: Tailwind CSS 3.0 + shadcn/ui
  State: Zustand 4.0
  HTTP: Axios / Native Fetch

Backend:
  Runtime: Node.js 18 (Vercel Edge)
  Database: PostgreSQL 14 (Supabase)
  Auth: Supabase Auth (OAuth)
  Storage: Supabase Storage

AI & APIs:
  AI: OpenAI GPT-3.5-turbo
  Translation: Google Chrome (MVP)
  Notifications: Kakao API + SendGrid
  Analytics: Google Analytics 4

DevOps:
  Hosting: Vercel
  CDN: CloudFlare
  CI/CD: GitHub Actions
```

---

## ğŸ’¾ ë°ì´í„°ë² ì´ìŠ¤ ì„¤ê³„

### í•µì‹¬ í…Œì´ë¸” êµ¬ì¡°
```sql
-- Users (ê°„ì†Œí™”)
CREATE TABLE users (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  email VARCHAR(255) UNIQUE NOT NULL,
  name VARCHAR(100) NOT NULL,
  avatar_url TEXT,
  provider VARCHAR(50), -- 'kakao', 'google', 'facebook'

  -- Optional Info (ì§„ì…ì¥ë²½ ë‚®ì¶¤)
  visa_type VARCHAR(20),
  company VARCHAR(100),
  years_in_korea INTEGER,
  region VARCHAR(50),
  preferred_language VARCHAR(10) DEFAULT 'ko',

  -- Badges (ë ˆë²¨/í¬ì¸íŠ¸ ì œê±°)
  badges JSONB DEFAULT '{
    "senior": false,
    "expert": false,
    "verified": false,
    "helper": false
  }'::jsonb,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  last_active TIMESTAMPTZ DEFAULT NOW()
);

-- Questions
CREATE TABLE questions (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  author_id UUID REFERENCES users(id),
  title VARCHAR(200) NOT NULL,
  content TEXT NOT NULL,

  -- AI Classification
  category_id INTEGER NOT NULL,
  ai_category_confidence FLOAT,
  tags TEXT[],
  urgency VARCHAR(20) DEFAULT 'NORMAL',

  -- Smart Matching
  matched_experts UUID[],

  -- Metadata
  view_count INTEGER DEFAULT 0,
  answer_count INTEGER DEFAULT 0,
  status VARCHAR(20) DEFAULT 'open',

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Answers
CREATE TABLE answers (
  id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
  question_id UUID REFERENCES questions(id),
  author_id UUID REFERENCES users(id),
  content TEXT NOT NULL,

  is_accepted BOOLEAN DEFAULT false,
  helpful_count INTEGER DEFAULT 0,

  created_at TIMESTAMPTZ DEFAULT NOW(),
  updated_at TIMESTAMPTZ DEFAULT NOW()
);
```

---

## ğŸ¨ UI/UX ì„¤ê³„

### ë””ìì¸ ì›ì¹™
1. **Mobile First**: 360px ê¸°ì¤€ ì„¤ê³„
2. **ë‚®ì€ ì§„ì…ì¥ë²½**: ë¡œê·¸ì¸ ì—†ì´ ì½˜í…ì¸  ì—´ëŒ
3. **ì‹ ë¢° ì‹œê°í™”**: ë ˆë²¨, ë±ƒì§€, ê±°ì£¼ë…„ì°¨ í‘œì‹œ
4. **ë‹¨ìˆœí•¨**: ê´‘ê³  ì—†ì´ í•µì‹¬ ê¸°ëŠ¥ì— ì§‘ì¤‘

### ìƒ‰ìƒ ì‹œìŠ¤í…œ
```css
:root {
  /* Primary Colors */
  --primary: #EA4335;      /* ë² íŠ¸ë‚¨ êµ­ê¸° ë¹¨ê°• */
  --secondary: #FFCD00;    /* ë² íŠ¸ë‚¨ êµ­ê¸° ë…¸ë‘ */

  /* Trust Colors */
  --verified: #10B981;     /* ì¸ì¦ ì´ˆë¡ */
  --expert: #F59E0B;       /* ì „ë¬¸ê°€ ê³¨ë“œ */

  /* UI Colors */
  --background: #FFFFFF;
  --surface: #F9FAFB;
  --border: #E5E7EB;
  --text-primary: #111827;
  --text-secondary: #6B7280;
}
```

### A/B í…ŒìŠ¤íŠ¸ UI ì„¤ê³„

#### Version A: ì§ˆë¬¸ ìš°ì„ í˜• (ê¸°ë³¸)
- ì§ˆë¬¸ ì‘ì„± í¼ì´ ìƒë‹¨ì— ë°°ì¹˜
- ì¸ê¸° Q&A ëª©ë¡ ì¤‘ì‹¬
- CTA: "ì§ˆë¬¸í•˜ê¸°" ë²„íŠ¼ ê°•ì¡°

#### Version B: ê²€ìƒ‰ ìš°ì„ í˜•
- ê²€ìƒ‰ë°”ê°€ ìƒë‹¨ì— ë°°ì¹˜
- ì¹´í…Œê³ ë¦¬ë³„ ë‹µë³€ ëª©ë¡ ì¤‘ì‹¬
- CTA: "ê²€ìƒ‰í•˜ê¸°" ì¤‘ì‹¬

### ëª¨ë°”ì¼ ë°˜ì‘í˜• ì„¤ê³„
```scss
// ë¸Œë ˆì´í¬í¬ì¸íŠ¸
$mobile: 360px;   // ê¸°ì¤€ í™”ë©´
$tablet: 768px;   // íƒœë¸”ë¦¿
$desktop: 1024px; // ë°ìŠ¤í¬í†±

// í„°ì¹˜ ì¹œí™”ì  ìš”ì†Œ
.touch-target {
  min-height: 44px; // iOS ê¸°ì¤€
  min-width: 44px;
  padding: 12px;
}

// Bottom Navigation (ëª¨ë°”ì¼)
.bottom-nav {
  position: fixed;
  bottom: 0;
  height: 56px;
  padding-bottom: env(safe-area-inset-bottom);
}
```

---

## ğŸ” ì¸ì¦ ì‹œìŠ¤í…œ

### ê°„ì†Œí™”ëœ OAuth í”Œë¡œìš°
```mermaid
sequenceDiagram
    participant User
    participant Client
    participant Supabase
    participant OAuth Provider

    User->>Client: 1. Click Social Login
    Client->>Supabase: 2. Request OAuth
    Supabase->>OAuth Provider: 3. Redirect to Provider
    OAuth Provider->>User: 4. Login & Consent
    User->>OAuth Provider: 5. Approve
    OAuth Provider->>Supabase: 6. Return Token
    Supabase->>Client: 7. Create Session
    Client->>User: 8. Redirect to App
```

### ê¶Œí•œ ì²´ê³„
```typescript
enum UserRole {
  GUEST = 'guest',        // ë¹„ë¡œê·¸ì¸ ì‚¬ìš©ì
  USER = 'user',          // ì¼ë°˜ íšŒì›
  VERIFIED = 'verified',  // ì¸ì¦ íšŒì› (ì„ íƒ)
  ADMIN = 'admin'         // ê´€ë¦¬ì
}
```

---

## ğŸ¤– AI ê¸°ëŠ¥ êµ¬í˜„

### ì§ˆë¬¸ ë¶„ë¥˜ ì‹œìŠ¤í…œ
```typescript
interface AIProcessingPipeline {
  // Step 1: Receive Question
  input: {
    title: string;
    content: string;
    userLanguage: 'ko' | 'vi' | 'en';
  };

  // Step 2: GPT-3.5 Classification
  classification: {
    model: 'gpt-3.5-turbo';
    prompt: 'Classify Korean life question';
    response: {
      category: string;
      confidence: number;
      urgency: 'LOW' | 'MEDIUM' | 'HIGH' | 'URGENT';
      tags: string[];
    };
  };

  // Step 3: Expert Matching
  matching: {
    algorithm: 'score_based';
    factors: {
      categoryMatch: 0.4;
      visaTypeMatch: 0.3;
      verifiedStatus: 0.2;
      responseRate: 0.1;
    };
    output: Expert[5]; // Top 5 experts
  };
}
```

### AI ë¹„ìš© ìµœì í™”
```javascript
const AI_CACHE_STRATEGY = {
  // Cache similar questions
  similarityThreshold: 0.85,

  // Cache duration
  ttl: {
    classification: 3600, // 1 hour
    matching: 1800, // 30 minutes
  },

  // Rate limiting
  rateLimit: {
    perUser: 10, // per hour
    global: 1000, // per hour
  },

  // Estimated costs
  monthlyCost: {
    withoutCache: "$150/month",
    withCache: "$30/month" // 80% reduction
  }
};
```

---

## ğŸŒ ë²ˆì—­ ì „ëµ

### Phase 1: MVP (êµ¬ê¸€ ë²ˆì—­ í™œìš©)
```typescript
const TranslationStrategy = {
  phase: "MVP",
  approach: "Browser-based",
  implementation: {
    desktop: "Chrome/Edge auto-translate",
    mobile: "Chrome mobile translation",
    fallback: "User manual copy-paste"
  },
  userGuidance: {
    ko: "Chrome ë²ˆì—­ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì„¸ìš”",
    vi: "Sá»­ dá»¥ng tÃ­nh nÄƒng dá»‹ch cá»§a Chrome",
    en: "Use Chrome translation feature"
  },
  cost: 0,
  devTime: "0 days"
};
```

### Phase 2: í•˜ì´ë¸Œë¦¬ë“œ ë²ˆì—­ (í–¥í›„)
```typescript
const HybridTranslation = {
  // Priority 1: UI Elements (i18n)
  staticContent: {
    method: "i18next",
    languages: ['ko', 'vi', 'en'],
    files: "locales/*.json",
    cost: 0
  },

  // Priority 2: Critical Content
  dynamicContent: {
    method: "Google Translate API",
    targets: ["categories", "system_messages", "faq_titles"],
    cost: "$20/month"
  },

  // Priority 3: User Content
  userContent: {
    method: "Browser translation",
    reason: "Cost optimization",
    cost: 0
  }
};
```

---

## ğŸ“± PWA ë° ëª¨ë°”ì¼ ìµœì í™”

### PWA ì„¤ì •
```javascript
// next.config.js
const withPWA = require('next-pwa')({
  dest: 'public',
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === 'development'
});

// manifest.json
{
  "name": "Viet K-Connect",
  "short_name": "VKC",
  "description": "ë² íŠ¸ë‚¨ì¸ í•œêµ­ìƒí™œ Q&A",
  "start_url": "/",
  "display": "standalone",
  "orientation": "portrait",
  "theme_color": "#10B981",
  "background_color": "#ffffff"
}
```

### Bottom Sheet êµ¬í˜„
```tsx
// Bottom Sheet Component
interface BottomSheetProps {
  isOpen: boolean
  onClose: () => void
  children: React.ReactNode
  title?: string
}

export function BottomSheet({ isOpen, onClose, children, title }: BottomSheetProps) {
  return (
    <AnimatePresence>
      {isOpen && (
        <>
          <motion.div
            initial={{ opacity: 0 }}
            animate={{ opacity: 0.5 }}
            exit={{ opacity: 0 }}
            className="fixed inset-0 bg-black z-40"
            onClick={onClose}
          />
          <motion.div
            initial={{ y: '100%' }}
            animate={{ y: 0 }}
            exit={{ y: '100%' }}
            className="fixed bottom-0 left-0 right-0 bg-white rounded-t-2xl z-50"
          >
            {children}
          </motion.div>
        </>
      )}
    </AnimatePresence>
  )
}
```

---

## ğŸ”” ì•Œë¦¼ ì‹œìŠ¤í…œ

### ë‹¤ì¤‘ ì±„ë„ ì•Œë¦¼
```typescript
interface NotificationSystem {
  channels: {
    inApp: {
      technology: "Supabase Realtime",
      latency: "<100ms",
      cost: "Free"
    },
    push: {
      technology: "FCM (Firebase)",
      latency: "<1s",
      cost: "Free (10k/month)"
    },
    kakaoTalk: {
      technology: "Kakao Alimtalk API",
      latency: "<3s",
      cost: "â‚©20/message"
    },
    email: {
      technology: "SendGrid",
      latency: "<5s",
      cost: "Free (100/day)"
    }
  };

  types: {
    newAnswer: ["inApp", "push", "kakaoTalk"],
    expertMatch: ["inApp", "push"],
    answerAccepted: ["inApp", "email"],
    weeklyDigest: ["email"]
  };
}
```

---

## ğŸš€ ë°°í¬ ë° ì„±ëŠ¥ ìµœì í™”

### ë°°í¬ ì•„í‚¤í…ì²˜
```yaml
Production Environment:
  Hosting:
    - Platform: Vercel
    - Region: Asia (Seoul - icn1)
    - Type: Serverless Functions

  Database:
    - Provider: Supabase
    - Type: PostgreSQL 14
    - Region: Asia Pacific (Seoul)

  Monitoring:
    - Analytics: Google Analytics 4
    - Errors: Sentry
    - Uptime: Vercel Analytics
```

### ì„±ëŠ¥ ìµœì í™”
```typescript
// Frontend Optimization
const FrontendOptimization = {
  bundleSize: {
    target: "<200KB initial",
    techniques: [
      "Code splitting",
      "Tree shaking",
      "Dynamic imports",
      "Image optimization"
    ]
  },

  caching: {
    static: "30 days",
    api: "5 minutes",
    images: "7 days"
  },

  rendering: {
    strategy: "ISR (Incremental Static Regeneration)",
    revalidate: 60, // seconds
    fallback: true
  }
};
```

---

## ğŸ”’ ë³´ì•ˆ ì„¤ì •

### ë³´ì•ˆ ê³„ì¸µ
```typescript
const AppSecurity = {
  authentication: {
    provider: "Supabase Auth",
    methods: ["OAuth 2.0"],
    session: "JWT (HttpOnly Cookie)",
    refresh: "Automatic"
  },

  authorization: {
    method: "Row Level Security (RLS)",
    policies: [
      "Users can read all questions",
      "Users can edit own content",
      "Admins can moderate all"
    ]
  },

  dataProtection: {
    encryption: "TLS 1.3",
    database: "AES-256",
    passwords: "Not stored (OAuth only)",
    pii: "Minimal collection"
  }
};
```

### ë³´ì•ˆ êµ¬í˜„ ìš°ì„ ìˆœìœ„

| Category | Feature | Implementation | Level | Priority |
|----------|---------|---------------|--------|----------|
| **Authentication** | | | | |
| | OAuth 2.0 | Supabase Auth with Kakao/Google/Facebook | High | P0 |
| | Session Management | JWT with HttpOnly Cookies | High | P0 |
| | Refresh Token | Automatic token refresh | High | P0 |
| | MFA | Two-factor authentication | Medium | P2 |
| **Authorization** | | | | |
| | Row Level Security | PostgreSQL RLS policies | High | P0 |
| | Role-based Access | User/Admin/Guest roles | High | P0 |
| | API Protection | Middleware authentication check | High | P0 |
| | Resource Limits | Rate limiting per user | Medium | P1 |
| **Data Protection** | | | | |
| | Encryption in Transit | TLS 1.3 | High | P0 |
| | Database Encryption | AES-256 | High | P0 |
| | PII Handling | Minimal collection, anonymization | High | P0 |
| | Backup & Recovery | Daily automated backups | High | P1 |
| **Content Security** | | | | |
| | Input Validation | XSS/SQL injection prevention | High | P0 |
| | File Upload Scanning | Malware/virus scanning | Medium | P1 |
| | Content Moderation | AI-based inappropriate content detection | Medium | P1 |
| | CORS Policy | Strict origin validation | High | P0 |

### RLS (Row Level Security) Policies

```sql
-- Questions: Everyone can read, authors can edit
CREATE POLICY "Questions are viewable by everyone"
ON questions FOR SELECT
USING (true);

CREATE POLICY "Users can create questions"
ON questions FOR INSERT
WITH CHECK (auth.uid() = author_id);

CREATE POLICY "Users can update own questions"
ON questions FOR UPDATE
USING (auth.uid() = author_id);

-- Answers: Everyone can read, authors can edit
CREATE POLICY "Answers are viewable by everyone"
ON answers FOR SELECT
USING (true);

CREATE POLICY "Authenticated users can create answers"
ON answers FOR INSERT
WITH CHECK (auth.uid() IS NOT NULL);

CREATE POLICY "Users can update own answers"
ON answers FOR UPDATE
USING (auth.uid() = author_id);

-- Users: Public profiles visible, private data protected
CREATE POLICY "Public profiles are viewable"
ON users FOR SELECT
USING (true);

CREATE POLICY "Users can update own profile"
ON users FOR UPDATE
USING (auth.uid() = id);

-- Notifications: Users see only their notifications
CREATE POLICY "Users can view own notifications"
ON notifications FOR SELECT
USING (auth.uid() = user_id);
```

---

## ğŸ“Š ì„±ëŠ¥ ì§€í‘œ ë° ëª¨ë‹ˆí„°ë§

### ì¶”ì í•  ì£¼ìš” ë©”íŠ¸ë¦­
```javascript
const UI_METRICS = {
  // ì§„ì… ì „í™˜ìœ¨
  landingToSignup: "30%",      // ë°©ë¬¸ â†’ ê°€ì…
  guestToUser: "25%",          // ê²ŒìŠ¤íŠ¸ â†’ íšŒì›

  // ì¸í„°ë™ì…˜
  questionCompletion: "70%",    // ì§ˆë¬¸ ì‘ì„± ì™„ë£Œìœ¨
  searchToQuestion: "15%",      // ê²€ìƒ‰ â†’ ì§ˆë¬¸ ì „í™˜

  // ëª¨ë°”ì¼
  mobileUsage: "80%",          // ëª¨ë°”ì¼ ì‚¬ìš© ë¹„ìœ¨
  appInstall: "40%",           // PWA ì„¤ì¹˜ìœ¨

  // A/B í…ŒìŠ¤íŠ¸
  versionAPreference: "60%",    // ì§ˆë¬¸ ìš°ì„ í˜• ì„ í˜¸
  versionBPreference: "40%",    // ê²€ìƒ‰ ìš°ì„ í˜• ì„ í˜¸
};
```

---

## ğŸ“ API ëª…ì„¸ ìƒì„¸

### Authentication Endpoints

#### POST /api/auth/login
```typescript
// Request
{
  provider: 'kakao' | 'google' | 'facebook',
  token: string
}

// Response
{
  user: {
    id: string,
    email: string,
    name: string,
    avatar_url?: string
  },
  jwt: string,
  refreshToken: string
}
```

#### POST /api/auth/logout
```typescript
// Request
{
  refreshToken: string
}

// Response
{
  success: boolean
}
```

#### GET /api/auth/session
```typescript
// Response
{
  user: User | null,
  isAuthenticated: boolean
}
```

### Question Endpoints

#### GET /api/questions
```typescript
// Query Parameters
{
  category?: number,
  status?: 'open' | 'closed' | 'solved',
  page?: number,
  limit?: number,
  sort?: 'latest' | 'popular' | 'unanswered'
}

// Response
{
  questions: Question[],
  total: number,
  page: number,
  hasMore: boolean
}
```

#### POST /api/questions
```typescript
// Request
{
  title: string,
  content: string,
  category?: number,
  urgency?: 'normal' | 'urgent',
  visibility?: 'public' | 'verified_only'
}

// Response
{
  questionId: string,
  aiCategory: number,
  aiTags: string[],
  matchedExperts: User[],
  createdAt: string
}
```

#### GET /api/questions/:id
```typescript
// Response
{
  question: {
    id: string,
    title: string,
    content: string,
    author: User,
    category: Category,
    tags: Tag[],
    viewCount: number,
    answerCount: number,
    createdAt: string,
    updatedAt: string
  },
  answers: Answer[],
  relatedQuestions: Question[]
}
```

### Answer Endpoints

#### POST /api/questions/:id/answers
```typescript
// Request
{
  content: string,
  images?: string[]
}

// Response
{
  answerId: string,
  createdAt: string
}
```

#### POST /api/answers/:id/accept
```typescript
// Response
{
  success: boolean,
  pointsAwarded: number
}
```

### AI Endpoints

#### POST /api/ai/classify
```typescript
// Request
{
  title: string,
  content: string,
  userLanguage: 'ko' | 'vi' | 'en'
}

// Response
{
  category: {
    id: number,
    name: string,
    confidence: number
  },
  tags: string[],
  urgency: 'low' | 'medium' | 'high' | 'urgent',
  similarQuestions: {
    id: string,
    title: string,
    similarity: number
  }[]
}
```

#### POST /api/ai/match
```typescript
// Request
{
  questionId: string,
  category: number,
  tags: string[]
}

// Response
{
  experts: {
    user: User,
    score: number,
    matchReasons: string[],
    responseRate: number,
    avgResponseTime: string
  }[],
  notificationsSent: number
}
```

### Notification Endpoints

#### GET /api/notifications
```typescript
// Query Parameters
{
  unreadOnly?: boolean,
  type?: 'answer' | 'comment' | 'accept' | 'mention',
  limit?: number
}

// Response
{
  notifications: Notification[],
  unreadCount: number
}
```

---

## ğŸ¯ í•µì‹¬ ì„¤ê³„ ì›ì¹™

### The 4 Pillars
1. **Trust**: ì‹¤ëª…, ì¸ì¦, ë ˆë²¨ë¡œ ì‹ ë¢° êµ¬ì¶•
2. **Speed**: ìµœëŒ€ 24ì‹œê°„ ë‹µë³€ ë³´ì¥
3. **Smart**: AI ë§¤ì¹­ìœ¼ë¡œ ìµœì  ë‹µë³€ì ì—°ê²°
4. **Simple**: 10ì´ˆ ê°€ì…, ì§ê´€ì  UI

### ì„±ê³µ ì§€í‘œ
- ê¸°ìˆ ì : ë¡œë”© 2ì´ˆ ì´ë‚´, ì—ëŸ¬ìœ¨ 1% ë¯¸ë§Œ, AI ì •í™•ë„ 80%+
- ë¹„ì¦ˆë‹ˆìŠ¤: ë² íƒ€ ì‚¬ìš©ì 50ëª…+, ë‹µë³€ë¥  60%+, NPS 30+

--

---

*ì´ ë¬¸ì„œëŠ” ë ˆê±°ì‹œ í”„ë¡œì íŠ¸ì˜ ê¸°ìˆ  ì„¤ê³„ë¥¼ í†µí•©í•œ ì°¸ê³  ë¬¸ì„œì…ë‹ˆë‹¤.*
*ì‹¤ì œ êµ¬í˜„ì€ `/Users/bk/Desktop/viet-kconnect/`ì—ì„œ ì§„í–‰í•˜ì„¸ìš”.*