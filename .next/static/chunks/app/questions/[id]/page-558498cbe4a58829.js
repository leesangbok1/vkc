(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[821],{1784:(e,s,t)=>{"use strict";t.d(s,{ClientProviders:()=>i,t:()=>n});var a=t(5155),r=t(2115);let l=(0,r.createContext)({user:null,profile:null,loading:!1,signInWithGoogle:async()=>console.log("Mock Google sign in"),signInWithFacebook:async()=>console.log("Mock Facebook sign in"),signInWithKakao:async()=>console.log("Mock Kakao sign in"),signOut:async()=>console.log("Mock sign out")}),n=()=>(0,r.useContext)(l);function i(e){let{children:s}=e,[t,n]=(0,r.useState)(!1);return((0,r.useEffect)(()=>{n(!0)},[]),t)?(0,a.jsx)(l.Provider,{value:{user:null,profile:null,loading:!1,signInWithGoogle:async()=>console.log("Mock Google sign in"),signInWithFacebook:async()=>console.log("Mock Facebook sign in"),signInWithKakao:async()=>console.log("Mock Kakao sign in"),signOut:async()=>console.log("Mock sign out")},children:s}):(0,a.jsx)("div",{className:"min-h-screen flex flex-col bg-gray-50",children:(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600 text-sm",children:"로딩 중..."})]})})})}},6990:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>h});var a=t(5155),r=t(2115),l=t(63),n=t(2619),i=t.n(n),c=t(1784);function o(e){let{targetId:s,targetType:t,initialVoteScore:l,currentUser:n,disabled:i=!1,onVoteUpdate:c}=e,[o,d]=(0,r.useState)(l),[x,m]=(0,r.useState)(null),[u,h]=(0,r.useState)(!1),[g,f]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(n)try{let a=await fetch("/api/".concat(t,"s/").concat(s,"/vote/status"));if(a.ok){var e;let s=await a.json();m((null==(e=s.data)?void 0:e.user_vote)||null)}}catch(e){}})()},[s,t,n]);let p=async e=>{if(!n)return void f("로그인이 필요합니다");if(i)return void f("본인의 게시물에는 투표할 수 없습니다");if(!u){h(!0),f(null);try{let a=e;x===e&&(a="cancel");let r=await fetch("/api/".concat(t,"s/").concat(s,"/vote"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({vote_type:a})}),l=await r.json();if(!r.ok)throw Error(l.error||"Failed to vote");d(l.data.vote_score),m(l.data.user_vote),c&&c(l.data.vote_score)}catch(e){f(e instanceof Error?e.message:"Something went wrong")}finally{h(!1)}}},j=e=>{let s="flex flex-col items-center p-2 rounded-lg transition-colors duration-200 min-w-[60px]";return i?"".concat(s," text-gray-400 cursor-not-allowed"):x===e?"up"===e?"".concat(s," text-green-600 bg-green-50 hover:bg-green-100"):"".concat(s," text-red-600 bg-red-50 hover:bg-red-100"):"".concat(s," text-gray-600 hover:text-gray-800 hover:bg-gray-100")};return(0,a.jsxs)("div",{className:"flex flex-col items-center space-y-1",children:[(0,a.jsxs)("button",{onClick:()=>p("up"),disabled:i||u||!n,className:j("up"),title:i?"본인의 게시물에는 투표할 수 없습니다":n?"up"===x?"추천 취소":"추천":"로그인이 필요합니다",children:[(0,a.jsx)("i",{className:"fas fa-chevron-up text-xl ".concat("up"===x?"animate-pulse":"")}),(0,a.jsx)("span",{className:"text-xs mt-1",children:"추천"})]}),(0,a.jsx)("div",{className:"py-2 px-3 rounded-lg font-bold text-lg ".concat(o>0?"text-green-600":o<0?"text-red-600":"text-gray-600"),children:0===o?"0":o>0?"+".concat(o):o.toString()}),(0,a.jsxs)("button",{onClick:()=>p("down"),disabled:i||u||!n,className:j("down"),title:i?"본인의 게시물에는 투표할 수 없습니다":n?"down"===x?"비추천 취소":"비추천":"로그인이 필요합니다",children:[(0,a.jsx)("i",{className:"fas fa-chevron-down text-xl ".concat("down"===x?"animate-pulse":"")}),(0,a.jsx)("span",{className:"text-xs mt-1",children:"비추천"})]}),u&&(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-white bg-opacity-75 rounded-lg",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"})}),g&&(0,a.jsxs)("div",{className:"absolute top-full mt-2 left-1/2 transform -translate-x-1/2 bg-red-100 border border-red-300 text-red-700 px-3 py-2 rounded-lg text-sm whitespace-nowrap z-10",children:[g,(0,a.jsx)("button",{onClick:()=>f(null),className:"ml-2 text-red-500 hover:text-red-700",children:(0,a.jsx)("i",{className:"fas fa-times"})})]}),!n&&!i&&(0,a.jsxs)("div",{className:"text-center mt-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"로그인하여"}),(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"투표하세요"})]}),i&&(0,a.jsx)("div",{className:"text-center mt-2",children:(0,a.jsx)("p",{className:"text-xs text-gray-400",children:"본인 게시물"})})]})}function d(e){var s,t;let{question:l,currentUser:n,onVoteUpdate:c}=e,[d,x]=(0,r.useState)(!1),m=e=>{let s=new Date(e),t=Math.ceil(Math.abs(new Date().getTime()-s.getTime())/864e5);return 1===t?"오늘":2===t?"어제":t<=7?"".concat(t,"일 전"):s.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})},u=(null==n?void 0:n.id)===l.author.id,h=l.content.length>500,g=h&&!d?l.content.substring(0,500)+"...":l.content;return(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm",children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium",style:{backgroundColor:"".concat(l.category.color,"20"),color:l.category.color},children:[(0,a.jsx)("i",{className:"".concat(l.category.icon," mr-2")}),l.category.name]}),l.urgency&&(e=>{switch(e){case"urgent":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[(0,a.jsx)("i",{className:"fas fa-exclamation-circle mr-1"}),"긴급"]});case"high":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[(0,a.jsx)("i",{className:"fas fa-clock mr-1"}),"중요"]});case"normal":return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[(0,a.jsx)("i",{className:"fas fa-info-circle mr-1"}),"일반"]});default:return null}})(l.urgency),"open"!==l.status&&(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:l.status})]}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:l.title}),(0,a.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-eye mr-1"}),"조회 ",(s=l.view_count)>=1e3?"".concat((s/1e3).toFixed(1),"k"):s.toString()]}),(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-comments mr-1"}),"답변 ",l.answer_count]}),(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-calendar mr-1"}),m(l.created_at)]}),l.created_at!==l.updated_at&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-edit mr-1"}),"수정됨 ",m(l.updated_at)]})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 ml-4",children:[u&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{href:"/questions/".concat(l.id,"/edit"),children:(0,a.jsx)("button",{className:"text-gray-600 hover:text-blue-600 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,a.jsx)("i",{className:"fas fa-edit"})})}),(0,a.jsx)("button",{className:"text-gray-600 hover:text-red-600 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,a.jsx)("i",{className:"fas fa-trash"})})]}),(0,a.jsx)("button",{className:"text-gray-600 hover:text-blue-600 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,a.jsx)("i",{className:"fas fa-share"})}),(0,a.jsx)("button",{className:"text-gray-600 hover:text-yellow-600 p-2 rounded-lg hover:bg-gray-100 transition-colors",children:(0,a.jsx)("i",{className:"fas fa-bookmark"})})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(o,{targetId:l.id,targetType:"question",initialVoteScore:l.vote_score,currentUser:n,disabled:u,onVoteUpdate:c})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"prose max-w-none",children:[(0,a.jsx)("div",{className:"text-gray-900 whitespace-pre-wrap leading-relaxed",children:g}),h&&(0,a.jsx)("button",{onClick:()=>x(!d),className:"mt-2 text-blue-600 hover:text-blue-700 font-medium",children:d?"접기":"더 보기"})]}),l.tags&&l.tags.length>0&&(0,a.jsx)("div",{className:"mt-6 pt-4 border-t border-gray-100",children:(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:l.tags.map((e,s)=>(0,a.jsxs)(i(),{href:"/questions?tag=".concat(encodeURIComponent(e)),className:"inline-flex items-center px-3 py-1 rounded-full text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 transition-colors",children:[(0,a.jsx)("i",{className:"fas fa-tag mr-1 text-xs"}),e]},s))})})]})]})}),(0,a.jsx)("div",{className:"px-6 pb-6",children:(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("img",{src:l.author.avatar_url||"/default-avatar.png",alt:l.author.name,className:"w-12 h-12 rounded-full border-2 border-gray-200"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(i(),{href:"/users/".concat(l.author.id),className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:l.author.name}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat((t=l.author.trust_score)>=90?"text-green-600":t>=70?"text-blue-600":t>=50?"text-yellow-600":"text-red-600"),children:["신뢰도 ",l.author.trust_score]})]}),(e=>{let s=Object.entries(e).filter(e=>{let[s,t]=e;return t});return 0===s.length?null:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["verified"===s&&(0,a.jsx)("i",{className:"fas fa-check-circle mr-1"}),"expert"===s&&(0,a.jsx)("i",{className:"fas fa-star mr-1"}),"helper"===s&&(0,a.jsx)("i",{className:"fas fa-hands-helping mr-1"}),"mentor"===s&&(0,a.jsx)("i",{className:"fas fa-graduation-cap mr-1"}),s]},s)})})})(l.author.badges),(0,a.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[l.author.visa_type&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-passport mr-1"}),l.author.visa_type]}),l.author.company&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-building mr-1"}),l.author.company]}),l.author.years_in_korea&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-calendar-alt mr-1"}),"한국 거주 ",l.author.years_in_korea,"년"]}),l.author.region&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-map-marker-alt mr-1"}),l.author.region]})]})})]})]})})})]})}function x(e){let{targetId:s,targetType:t,currentUser:l}=e,[n,c]=(0,r.useState)([]),[o,d]=(0,r.useState)(""),[x,m]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!0),[g,f]=(0,r.useState)(null),[p,j]=(0,r.useState)(!1);(0,r.useEffect)(()=>{(async()=>{try{h(!0);let e=await fetch("/api/".concat(t,"s/").concat(s,"/comments"));if(e.ok){let s=await e.json();c(s.data||[])}}catch(e){}finally{h(!1)}})()},[s,t]);let b=async e=>{if(e.preventDefault(),!l)return void f("로그인이 필요합니다");if(!o.trim())return void f("댓글 내용을 입력해주세요");if(o.length>500)return void f("댓글은 500자 이하로 작성해주세요");m(!0),f(null);try{let e=await fetch("/api/".concat(t,"s/").concat(s,"/comments"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:o.trim()})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to submit comment");c(e=>[...e,a.data]),d(""),j(!1)}catch(e){f(e instanceof Error?e.message:"Something went wrong")}finally{m(!1)}};return u?(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)("div",{className:"animate-pulse",children:[(0,a.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/4 mb-3"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded"}),(0,a.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"})]})]})}):(0,a.jsxs)("div",{className:"p-4 bg-gray-50",children:[(0,a.jsx)("div",{className:"mb-4",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h4",{className:"font-medium text-gray-900",children:["댓글 ",n.length,"개"]}),l&&!p&&(0,a.jsxs)("button",{onClick:()=>j(!0),className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:[(0,a.jsx)("i",{className:"fas fa-plus mr-1"}),"댓글 추가"]})]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[n.map(e=>{var s;return(0,a.jsx)("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("img",{src:e.author.avatar_url||"/default-avatar.png",alt:e.author.name,className:"w-8 h-8 rounded-full border border-gray-200 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(i(),{href:"/users/".concat(e.author.id),className:"font-medium text-gray-900 hover:text-blue-600 transition-colors text-sm",children:e.author.name}),(0,a.jsx)("span",{className:"text-xs ".concat((s=e.author.trust_score)>=90?"text-green-600":s>=70?"text-blue-600":s>=50?"text-yellow-600":"text-red-600"),children:e.author.trust_score}),(e=>{let s=Object.entries(e).filter(e=>{let[s,t]=e;return t});return 0===s.length?null:(0,a.jsx)("div",{className:"flex gap-1",children:s.slice(0,2).map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:"inline-flex items-center px-1 py-0.5 rounded text-xs font-medium bg-purple-100 text-purple-800",children:["verified"===s&&(0,a.jsx)("i",{className:"fas fa-check-circle mr-1"}),"expert"===s&&(0,a.jsx)("i",{className:"fas fa-star mr-1"}),s]},s)})})})(e.author.badges),(0,a.jsx)("span",{className:"text-xs text-gray-500",children:(e=>{let s=new Date(e),t=Math.abs(new Date().getTime()-s.getTime()),a=Math.ceil(t/6e4),r=Math.ceil(t/36e5),l=Math.ceil(t/864e5);return a<60?"".concat(a,"분 전"):r<24?"".concat(r,"시간 전"):l<=7?"".concat(l,"일 전"):s.toLocaleDateString("ko-KR",{month:"short",day:"numeric"})})(e.created_at)})]}),(0,a.jsx)("p",{className:"text-sm text-gray-700 leading-relaxed",children:e.content})]})]})},e.id)}),0===n.length&&(0,a.jsx)("div",{className:"text-center py-4 text-gray-500 text-sm",children:"아직 댓글이 없습니다."})]}),p&&l&&(0,a.jsx)("div",{className:"mt-4 p-4 bg-white rounded-lg border border-gray-200",children:(0,a.jsx)("form",{onSubmit:b,children:(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("img",{src:l.avatar_url||"/default-avatar.png",alt:l.name,className:"w-8 h-8 rounded-full border border-gray-200 flex-shrink-0"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("textarea",{value:o,onChange:e=>d(e.target.value),placeholder:"댓글을 작성해주세요...",className:"w-full p-2 border border-gray-300 rounded-lg resize-none focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",rows:3,disabled:x}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-2",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:[o.length,"/500자"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{j(!1),d(""),f(null)},className:"px-3 py-1 text-sm text-gray-600 hover:text-gray-800 transition-colors",disabled:x,children:"취소"}),(0,a.jsx)("button",{type:"submit",disabled:x||!o.trim()||o.length>500,className:"px-3 py-1 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-400 disabled:cursor-not-allowed text-white text-sm rounded transition-colors",children:x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fas fa-spinner fa-spin mr-1"}),"등록 중..."]}):"등록"})]})]}),g&&(0,a.jsxs)("div",{className:"mt-2 text-sm text-red-600",children:[(0,a.jsx)("i",{className:"fas fa-exclamation-triangle mr-1"}),g]})]})]})})}),!l&&(0,a.jsx)("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg text-center",children:(0,a.jsxs)("p",{className:"text-sm text-blue-700",children:[(0,a.jsx)("i",{className:"fas fa-sign-in-alt mr-1"}),"댓글을 작성하려면 로그인하세요"]})})]})}function m(e){let{answers:s,questionAuthorId:t,currentUser:l,onAnswerUpdate:n}=e,[c,d]=(0,r.useState)("accepted"),[m,u]=(0,r.useState)(new Set),[h,g]=(0,r.useState)(new Set),f=async e=>{if(l)try{(await fetch("/api/answers/".concat(e,"/accept"),{method:"POST",headers:{"Content-Type":"application/json"}})).ok&&n()}catch(e){}},p=async e=>{if(l)try{(await fetch("/api/answers/".concat(e,"/helpful"),{method:"POST",headers:{"Content-Type":"application/json"}})).ok&&n()}catch(e){}},j=(e=>{let s=[...e];switch(c){case"accepted":return s.sort((e,s)=>e.is_accepted&&!s.is_accepted?-1:!e.is_accepted&&s.is_accepted?1:e.is_helpful&&!s.is_helpful?-1:!e.is_helpful&&s.is_helpful?1:(s.vote_score||0)-(e.vote_score||0));case"helpful":return s.sort((e,s)=>e.is_helpful&&!s.is_helpful?-1:!e.is_helpful&&s.is_helpful?1:(s.vote_score||0)-(e.vote_score||0));case"votes":return s.sort((e,s)=>(s.vote_score||0)-(e.vote_score||0));case"newest":return s.sort((e,s)=>new Date(s.created_at).getTime()-new Date(e.created_at).getTime());case"oldest":return s.sort((e,s)=>new Date(e.created_at).getTime()-new Date(s.created_at).getTime());default:return s}})(s),b=(null==l?void 0:l.id)===t;return 0===s.length?(0,a.jsxs)("div",{className:"bg-white border border-gray-200 rounded-lg shadow-sm p-8 text-center",children:[(0,a.jsx)("i",{className:"fas fa-comments text-4xl text-gray-400 mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"아직 답변이 없습니다"}),(0,a.jsx)("p",{className:"text-gray-600",children:"이 질문에 첫 번째 답변을 남겨보세요!"})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900",children:["답변 ",s.length,"개"]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-sm text-gray-600",children:"정렬:"}),(0,a.jsxs)("select",{value:c,onChange:e=>d(e.target.value),className:"text-sm border border-gray-300 rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[(0,a.jsx)("option",{value:"accepted",children:"채택순"}),(0,a.jsx)("option",{value:"helpful",children:"도움순"}),(0,a.jsx)("option",{value:"votes",children:"추천순"}),(0,a.jsx)("option",{value:"newest",children:"최신순"}),(0,a.jsx)("option",{value:"oldest",children:"오래된순"})]})]})]}),j.map(e=>{var s;let t=e.content.length>600,r=m.has(e.id),n=t&&!r?e.content.substring(0,600)+"...":e.content,c=(null==l?void 0:l.id)===e.author.id;return(0,a.jsxs)("div",{className:"bg-white border-2 rounded-lg shadow-sm ".concat(e.is_accepted?"border-green-200 bg-green-50":e.is_helpful?"border-blue-200 bg-blue-50":"border-gray-200"),children:[(0,a.jsx)("div",{className:"p-6 border-b border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[e.is_accepted&&(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:[(0,a.jsx)("i",{className:"fas fa-check-circle mr-1"}),"채택된 답변"]}),e.is_helpful&&!e.is_accepted&&(0,a.jsxs)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800",children:[(0,a.jsx)("i",{className:"fas fa-thumbs-up mr-1"}),"도움이 되는 답변"]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[c&&(0,a.jsx)("button",{className:"text-gray-600 hover:text-blue-600 p-1 rounded hover:bg-gray-100 transition-colors",children:(0,a.jsx)("i",{className:"fas fa-edit"})}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:(e=>{let s=new Date(e),t=Math.abs(new Date().getTime()-s.getTime()),a=Math.ceil(t/6e4),r=Math.ceil(t/36e5),l=Math.ceil(t/864e5);return a<60?"".concat(a,"분 전"):r<24?"".concat(r,"시간 전"):l<=7?"".concat(l,"일 전"):s.toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"})})(e.created_at)})]})]})}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsxs)("div",{className:"flex gap-6",children:[(0,a.jsx)("div",{className:"flex-shrink-0",children:(0,a.jsx)(o,{targetId:e.id,targetType:"answer",initialVoteScore:e.vote_score,currentUser:l,disabled:c})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"prose max-w-none",children:[(0,a.jsx)("div",{className:"text-gray-900 whitespace-pre-wrap leading-relaxed",children:n}),t&&(0,a.jsx)("button",{onClick:()=>(e=>{let s=new Set(m);s.has(e)?s.delete(e):s.add(e),u(s)})(e.id),className:"mt-2 text-blue-600 hover:text-blue-700 font-medium",children:r?"접기":"더 보기"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-4 mt-4 pt-4 border-t border-gray-100",children:[b&&!e.is_accepted&&(0,a.jsxs)("button",{onClick:()=>f(e.id),className:"text-green-600 hover:text-green-700 font-medium",children:[(0,a.jsx)("i",{className:"fas fa-check mr-1"}),"답변 채택"]}),l&&!c&&!e.is_helpful&&(0,a.jsxs)("button",{onClick:()=>p(e.id),className:"text-blue-600 hover:text-blue-700 font-medium",children:[(0,a.jsx)("i",{className:"fas fa-thumbs-up mr-1"}),"도움됨"]}),(0,a.jsxs)("button",{onClick:()=>(e=>{let s=new Set(h);s.has(e)?s.delete(e):s.add(e),g(s)})(e.id),className:"text-gray-600 hover:text-gray-700",children:[(0,a.jsx)("i",{className:"fas fa-comment mr-1"}),"댓글"]}),(0,a.jsxs)("button",{className:"text-gray-600 hover:text-gray-700",children:[(0,a.jsx)("i",{className:"fas fa-share mr-1"}),"공유"]})]})]})]})}),(0,a.jsx)("div",{className:"px-6 pb-6",children:(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("img",{src:e.author.avatar_url||"/default-avatar.png",alt:e.author.name,className:"w-10 h-10 rounded-full border-2 border-gray-200"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,a.jsx)(i(),{href:"/users/".concat(e.author.id),className:"font-semibold text-gray-900 hover:text-blue-600 transition-colors",children:e.author.name}),(0,a.jsxs)("span",{className:"text-sm font-medium ".concat((s=e.author.trust_score)>=90?"text-green-600":s>=70?"text-blue-600":s>=50?"text-yellow-600":"text-red-600"),children:["신뢰도 ",e.author.trust_score]})]}),(e=>{let s=Object.entries(e).filter(e=>{let[s,t]=e;return t});return 0===s.length?null:(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:s.slice(0,3).map(e=>{let[s,t]=e;return(0,a.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:["verified"===s&&(0,a.jsx)("i",{className:"fas fa-check-circle mr-1"}),"expert"===s&&(0,a.jsx)("i",{className:"fas fa-star mr-1"}),"helper"===s&&(0,a.jsx)("i",{className:"fas fa-hands-helping mr-1"}),"mentor"===s&&(0,a.jsx)("i",{className:"fas fa-graduation-cap mr-1"}),s]},s)})})})(e.author.badges),(0,a.jsx)("div",{className:"mt-2 text-sm text-gray-600",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-4",children:[e.author.visa_type&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-passport mr-1"}),e.author.visa_type]}),e.author.years_in_korea&&(0,a.jsxs)("span",{children:[(0,a.jsx)("i",{className:"fas fa-calendar-alt mr-1"}),"한국 거주 ",e.author.years_in_korea,"년"]})]})})]})]})})}),h.has(e.id)&&(0,a.jsx)("div",{className:"border-t border-gray-100",children:(0,a.jsx)(x,{targetId:e.id,targetType:"answer",currentUser:l})})]},e.id)})]})}function u(e){let{questionId:s,onAnswerSubmitted:t}=e,[l,n]=(0,r.useState)(""),[i,c]=(0,r.useState)(!1),[o,d]=(0,r.useState)(null),[x,m]=(0,r.useState)(!1),u=(0,r.useRef)(null),h=async e=>{if(e.preventDefault(),!l.trim())return void d("답변 내용을 입력해주세요");if(l.length<10)return void d("답변은 최소 10자 이상 작성해주세요");c(!0),d(null);try{let e=await fetch("/api/answers",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({question_id:s,content:l.trim()})}),a=await e.json();if(!e.ok)throw Error(a.error||"Failed to submit answer");n(""),m(!1),t();let r=document.createElement("div");r.className="fixed top-4 right-4 bg-green-100 border border-green-300 text-green-700 px-4 py-2 rounded-lg z-50",r.textContent="답변이 성공적으로 등록되었습니다!",document.body.appendChild(r),setTimeout(()=>{document.body.removeChild(r)},3e3)}catch(e){d(e instanceof Error?e.message:"Something went wrong")}finally{c(!1)}},g=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",t=u.current;if(!t)return;let a=t.selectionStart,r=t.selectionEnd,i=l.substring(a,r),c=e+i+s;n(l.substring(0,a)+c+l.substring(r)),setTimeout(()=>{let r=a+e.length+i.length+s.length;t.focus(),t.setSelectionRange(r,r)},0)};return(0,a.jsxs)("div",{className:"form-answer-container",children:[(0,a.jsx)("div",{className:"form-answer-header",children:"답변 작성"}),(0,a.jsxs)("div",{className:"form-answer-content",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 sr-only",children:"답변 작성"}),(0,a.jsxs)("form",{onSubmit:h,children:[(0,a.jsxs)("div",{className:"form-answer-toolbar",children:[[{icon:"fas fa-bold",action:()=>g("**","**"),title:"굵게 (Ctrl+B)"},{icon:"fas fa-italic",action:()=>g("*","*"),title:"기울임 (Ctrl+I)"},{icon:"fas fa-code",action:()=>g("`","`"),title:"인라인 코드"},{icon:"fas fa-link",action:()=>g("[","](url)"),title:"링크"},{icon:"fas fa-list-ul",action:()=>g("\n- ",""),title:"목록"},{icon:"fas fa-list-ol",action:()=>g("\n1. ",""),title:"번호 목록"},{icon:"fas fa-quote-right",action:()=>g("\n> ",""),title:"인용"}].map((e,s)=>(0,a.jsx)("button",{type:"button",onClick:e.action,title:e.title,className:"p-2 text-primary-blue hover:text-white hover:bg-primary-blue rounded transition-colors",children:(0,a.jsx)("i",{className:e.icon})},s)),(0,a.jsx)("div",{className:"separator"}),(0,a.jsx)("button",{type:"button",onClick:()=>m(!x),className:"form-answer-preview-btn ".concat(x?"active":""),children:x?"편집":"미리보기"})]}),x?(0,a.jsx)("div",{className:"form-answer-preview",children:(0,a.jsx)("div",{className:"prose max-w-none",children:(0,a.jsx)("div",{className:"text-gray-900 whitespace-pre-wrap leading-relaxed",children:l||"미리보기할 내용이 없습니다."})})}):(0,a.jsx)("textarea",{ref:u,value:l,onChange:e=>n(e.target.value),onKeyDown:e=>{if("Tab"===e.key){e.preventDefault();let s=u.current;if(s){let e=s.selectionStart,t=s.selectionEnd,a=s.value;n(a.substring(0,e)+"    "+a.substring(t)),setTimeout(()=>{s.selectionStart=s.selectionEnd=e+4},0)}}(e.ctrlKey||e.metaKey)&&"Enter"===e.key&&(e.preventDefault(),h(e))},placeholder:"이 질문에 대한 답변을 작성해주세요.  도움이 되는 답변을 위한 팁: • 구체적이고 명확한 설명을 제공하세요 • 개인 경험이나 사례를 포함하면 더욱 도움이 됩니다 • 관련 링크나 참고 자료를 추가해보세요 • 정중하고 친근한 톤으로 작성해주세요",className:"form-answer-textarea",disabled:i}),(0,a.jsxs)("div",{className:"flex justify-between items-center mt-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("span",{className:l.length<10?"text-red-500":"text-gray-600",children:[l.length,"자"]}),(0,a.jsx)("span",{className:"ml-1",children:"/ 최소 10자"})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500",children:"Ctrl + Enter로 빠른 등록"})]}),o&&(0,a.jsxs)("div",{className:"form-primary-error",children:[(0,a.jsx)("i",{className:"fas fa-exclamation-triangle"}),(0,a.jsx)("span",{children:o})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mt-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("i",{className:"fas fa-info-circle mr-1"}),"답변은 등록 후 수정할 수 있습니다"]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("button",{type:"button",onClick:()=>{n(""),m(!1),d(null)},className:"px-4 py-2 text-gray-600 hover:text-gray-800 transition-colors",disabled:i,children:"초기화"}),(0,a.jsx)("button",{type:"submit",disabled:i||!l.trim()||l.length<10,className:"form-answer-submit px-6 py-2",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"답변 등록 중..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("i",{className:"fas fa-paper-plane mr-2"}),"답변 등록"]})})]})]})]}),(0,a.jsxs)("div",{className:"form-primary-guidelines",children:[(0,a.jsxs)("h4",{children:[(0,a.jsx)("i",{className:"fas fa-lightbulb"}),"좋은 답변을 위한 가이드라인"]}),(0,a.jsxs)("ul",{children:[(0,a.jsx)("li",{children:"• 질문에 직접적으로 답변하되, 구체적인 방법이나 단계를 제시하세요"}),(0,a.jsx)("li",{children:"• 개인적인 경험이나 실제 사례를 포함하면 더욱 도움이 됩니다"}),(0,a.jsx)("li",{children:"• 관련 웹사이트, 문서, 또는 연락처 정보를 제공해주세요"}),(0,a.jsx)("li",{children:"• 정확하지 않은 정보보다는 모르겠다고 솔직히 말하는 것이 좋습니다"}),(0,a.jsx)("li",{children:"• 정중하고 친근한 톤으로 작성해주세요"})]})]})]})]})}function h(){let e=(0,l.useParams)();(0,l.useRouter)();let{user:s,profile:t,loading:n}=(0,c.t)(),[o,x]=(0,r.useState)(null),[h,g]=(0,r.useState)(!0),[f,p]=(0,r.useState)(null),[j,b]=(0,r.useState)(0),N=e.id;(0,r.useEffect)(()=>{let e=async()=>{try{g(!0),p(null);let e=await fetch("/api/questions/".concat(N)),s=await e.json();if(!e.ok)throw Error(s.error||"Failed to fetch question");x(s.data)}catch(e){p(e instanceof Error?e.message:"Something went wrong")}finally{g(!1)}};N&&e()},[N,j]);let v=()=>{b(e=>e+1)};return n||h?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"질문을 불러오는 중..."})]})}):f?(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:[(0,a.jsx)("i",{className:"fas fa-exclamation-triangle text-4xl text-red-500 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-red-800 mb-2",children:"오류가 발생했습니다"}),(0,a.jsx)("p",{className:"text-red-600 mb-4",children:f}),(0,a.jsxs)("div",{className:"flex gap-2 justify-center",children:[(0,a.jsx)("button",{onClick:()=>b(e=>e+1),className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg transition-colors",children:"다시 시도"}),(0,a.jsx)(i(),{href:"/questions",children:(0,a.jsx)("button",{className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg transition-colors",children:"목록으로 돌아가기"})})]})]})})}):o?(0,a.jsx)("div",{className:"min-h-screen bg-background",children:(0,a.jsxs)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("nav",{className:"mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[(0,a.jsx)(i(),{href:"/",className:"hover:text-blue-600 transition-colors",children:"홈"}),(0,a.jsx)("i",{className:"fas fa-chevron-right text-xs"}),(0,a.jsx)(i(),{href:"/questions",className:"hover:text-blue-600 transition-colors",children:"질문과 답변"}),(0,a.jsx)("i",{className:"fas fa-chevron-right text-xs"}),(0,a.jsx)("span",{className:"text-gray-900",children:o.title})]})}),(0,a.jsx)(d,{question:o,currentUser:t,onVoteUpdate:e=>{o&&x(s=>s?{...s,vote_score:e}:null)}}),s&&t&&(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(u,{questionId:o.id,onAnswerSubmitted:v})}),!s&&(0,a.jsxs)("div",{className:"mt-8 bg-blue-50 border border-blue-200 rounded-lg p-6 text-center",children:[(0,a.jsx)("i",{className:"fas fa-sign-in-alt text-3xl text-blue-600 mb-3"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-blue-800 mb-2",children:"답변을 작성하려면 로그인하세요"}),(0,a.jsx)("p",{className:"text-blue-600 mb-4",children:"이 질문에 도움이 되는 답변을 남겨주세요. 로그인 후 답변을 작성할 수 있습니다."}),(0,a.jsx)("button",{onClick:()=>{},className:"bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg transition-colors",children:"로그인하기"})]}),(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsx)(m,{answers:o.answers||[],questionAuthorId:o.author.id,currentUser:t,onAnswerUpdate:v})}),(0,a.jsxs)("div",{className:"mt-12 border-t pt-8",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"관련 질문"}),(0,a.jsx)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:(0,a.jsx)("p",{className:"text-gray-600",children:"관련 질문 기능은 곧 추가될 예정입니다."})})]})]})}):(0,a.jsx)("div",{className:"min-h-screen flex items-center justify-center",children:(0,a.jsx)("div",{className:"text-center max-w-md mx-auto",children:(0,a.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[(0,a.jsx)("i",{className:"fas fa-question-circle text-4xl text-gray-400 mb-4"}),(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"질문을 찾을 수 없습니다"}),(0,a.jsx)("p",{className:"text-gray-600 mb-4",children:"요청하신 질문이 존재하지 않거나 삭제되었습니다."}),(0,a.jsx)(i(),{href:"/questions",children:(0,a.jsx)("button",{className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg transition-colors",children:"목록으로 돌아가기"})})]})})})}},7704:(e,s,t)=>{Promise.resolve().then(t.bind(t,6990))}},e=>{e.O(0,[96,358],()=>e(e.s=7704)),_N_E=e.O()}]);